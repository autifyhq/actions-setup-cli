name: 'Setup Autify Command Line Interface (CLI)'
description: 'Install Autify CLI and add it to PATH'
author: 'Autify Inc.'

inputs:
  shell-installer-url:
    required: false
    description: 'Shell installer URL'
    # TODO: Use stable
    default: "https://autify-cli-assets.s3.amazonaws.com/autify-cli/channels/beta/install-cicd.bash"
  use-cache:
    required: false
    description: 'Use cached CLI installed by previous steps if existing.'
    default: 'false'
  install-cli-integration-test:
    required: false
    description: 'Install autify-cli-integration-test package as well.'
    default: 'false'

runs:
  using: 'composite'
  steps:
    - if: ${{ inputs.install-cli-integration-test == 'true' }}
      uses: actions/setup-node@v3
    - run: $GITHUB_ACTION_PATH/script.bash
      shell: bash
      env:
        INPUT_SHELL_INSTALLER_URL: ${{ inputs.shell-installer-url }}
        INPUT_USE_CACHE: ${{ inputs.use-cache }}
        INPUT_INSTALL_CLI_INTEGRATION_TEST: ${{ inputs.install-cli-integration-test }}
    - run: autify --version
      shell: bash
